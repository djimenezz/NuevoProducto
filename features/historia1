Feature: Transferencias nacionales

  Como usuario,
  quiero realizar transferencias nacionales de forma segura,
  para enviar dinero dentro del país cumpliendo las condiciones requeridas.

  Background:
    Given el usuario está autenticado
    And el número de teléfono registrado es español (+34)

  Scenario: Transferencia permitida sin requisitos adicionales
    Given el usuario solicita una transferencia nacional entre 1.001 y 50.000 euros
    And el país destino no está restringido
    When el usuario confirma la operación
    Then el sistema efectúa la transferencia exitosamente
    And se muestra mensaje de éxito

  Scenario: Transferencia rechazada por monto insuficiente
    Given el usuario solicita una transferencia nacional de 1.000 euros o menos
    When el usuario confirma la operación
    Then el sistema rechaza la transferencia
    And se muestra mensaje indicando que el monto mínimo es superior a 1.000 euros

  Scenario: Transferencia que requiere verificación OTP
    Given el usuario solicita una transferencia nacional superior a 50.000 euros
    And el país destino no está restringido
    When el usuario confirma la operación
    Then el sistema solicita OTP y lo envía por SMS
    When el usuario introduce el OTP válido en menos de 5 minutos
    Then el sistema efectúa la transferencia exitosamente
    And se muestra mensaje de éxito

  Scenario: OTP expirado
    Given el sistema solicita OTP para una transferencia superior a 50.000 euros
    When el usuario introduce el OTP después de 5 minutos
    Then el sistema rechaza la transferencia
    And se muestra mensaje de OTP expirado

  Scenario: Transferencia rechazada por teléfono no español
    Given el usuario tiene un número de teléfono no español
    When solicita una transferencia nacional
    Then el sistema rechaza la operación
    And se muestra mensaje indicando que el teléfono debe ser español

  Scenario: Transferencia rechazada por país destino restringido
    Given el usuario solicita una transferencia nacional a país restringido
    When confirma la operación
    Then el sistema rechaza la transferencia
    And se muestra mensaje indicando restricción de país
